<?xml version="1.0" encoding="UTF-8"?>
<!-- Â© 2016 ClearCorp
     License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html). -->

<odoo>
    <!-- Adds quote states to project.scrum.feature -->
    <!-- form -->
    <record id="view_feature_form" model="ir.ui.view">
        <field name="name">Feature View Form</field>
        <field name="model">project.scrum.feature</field>
        <field name="inherit_id" ref="project_scrum_method.view_feature_form"/>
        <field name="arch" type="xml">
            <xpath expr="//form/header/button[@name='set_cancel']"
                position="after">
                <button name="set_quote_pending" type="object"
                    string="Quote Pending" class="oe_highlight"/>
                <button name="set_quoted" type="object"
                    string="Quoted" />
            </xpath>
            <!-- Same view, other model -->
            <!--xpath expr="//page[@name='description']" position="after">
                <field name="ticket_id" widget="one2many_list"/>
            </xpath-->
        </field>
    </record>

    <!-- Adds approvals to issue tracking-view -->
    <record model="ir.ui.view" id="project_issue_form_view_invoice">
        <field name="name">Project Issue Tracker Form Approvals</field>
        <field name="model">project.issue</field>
        <field name="inherit_id" ref="project_issue.project_issue_form_view"/>
        <field name="priority" eval="150" />
        <field name="arch" type="xml">
            <xpath expr="//notebook/page[@name='extra_info']" position="before">
                <page string="Approvals" name="issue_approvals">
                    <h3><label for="feature_id" string="Related Feature" class="oe_inline"/></h3>
                    <field name="feature_id" string="Feature" required="1"
                           context="{
                            'default_project_id': project_id,
                            'default_partner_id': partner_id,
                            'default_state': 'draft'
                           }"/>
                    <field name="prepaid_hours_approval_id" widget="one2many_list" mode="tree" attrs="{'readonly': [('feature_id', '=', False)]}"
                           context="{
                            'default_ticket_id': active_id,
                            'default_user_id': partner_id
                            }">
                        <tree string="Approvals" name="approvals">
                            <field name="user_id"/>
                            <field name="date"/>
                            <field name="sequence"/>
                            <field name="state" widget="selection"/>
                        </tree>
                        <form>
                            <group>
                                <group>
                                    <field name="user_id"/>
                                    <field name="date"/>
                                </group>
                                <group>
                                    <field name="sequence"/>
                                    <field name="state" widget="selection"/>
                                </group>
                                <field name="approval_line_ids" widget="one2many_list" mode="tree">
                                    <tree string="Approval Lines" editable="bottom">
                                        <field name="prepaid_hours_id"/>
                                        <field name="work_type_id"/>
                                    </tree>
                                </field>
                                <group>
                                    <button string="Create Proposal" type="object" name="create_proposed_hour_values"/>
                                </group>
                                <field name="approval_values" widget="one2many_list" mode="tree">
                                    <tree>
                                        <field name="prepaid_hours_id"/>
                                        <field name="prepaid_hours" readonly="1"/>
                                        <field name="time_already_approved" readonly="1"/>
                                        <field name="remaining_hours" readonly="1"/>
                                        <field name="hours_to_be_approved" readonly="1"/>
                                        <field name="requested_hours" readonly="1"/>
                                        <field name="extra_hours" readonly="1"/>
                                        <field name="extra_amount" readonly="1"/>
                                    </tree>
                                </field>
                            </group>
                        </form>
                    </field>
                    <!--div style="padding-bottom:16px">
                        <h2 style="display:inline; margin-right:24px">Approval 1</h2>
                        <span>
                            Estado
                            <button style="margin-left:16px"
                                name="" string="Approve" />
                        </span>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th></th>
                                <th style="text-align:right">Sin Bolsa</th>
                                <th style="text-align:right">Bolsa 1</th>
                                <th style="text-align:right">Bolsa 2</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Horas Bolsa</td>
                                <td style="text-align:right">-</td>
                                <td style="text-align:right">10</td>
                                <td style="text-align:right">20</td>
                            </tr>
                            <tr>
                                <td>Horas Consumidas</td>
                                <td style="text-align:right">-</td>
                                <td style="text-align:right">8</td>
                                <td style="text-align:right">15</td>
                            </tr>
                            <tr style="border-top:1px solid black">
                                <td style="padding-bottom:16px">
                                    <b>Horas Restantes</b>
                                </td>
                                <td style="text-align:right">
                                    <b>-</b>
                                </td>
                                <td style="text-align:right">
                                    <b>2</b>
                                </td>
                                <td style="text-align:right">
                                    <b>5</b>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Horas por aprobar</b>
                                </td>
                                <td style="text-align:right">
                                    <b>14</b>
                                </td>
                                <td style="text-align:right">
                                    <b>12</b>
                                </td>
                                <td style="text-align:right">
                                    <b>5</b>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Horas requeridas</b>
                                    <ul style="list-style-type:none">
                                        <li>Analisis Funcional
                                            remoto</li>
                                        <li>Desarrollo remoto</li>
                                        <li>Desarrollo Extra remoto
                                        </li>
                                        <li>Analisis tecnico remoto
                                        </li>
                                    </ul>
                                </td>
                                <td style="text-align:right">
                                    <b>7</b>
                                    <ul style="list-style-type:none">
                                        <li>2</li>
                                        <li>2</li>
                                        <li>2</li>
                                        <li>1</li>
                                    </ul>
                                </td>
                                <td style="text-align:right">
                                    <b>4</b>
                                    <ul style="list-style-type:none">
                                        <li>1</li>
                                        <li>1</li>
                                        <li>1</li>
                                        <li>1</li>
                                    </ul>
                                </td>
                                <td style="text-align:right">
                                    <b>5</b>
                                    <ul style="list-style-type:none">
                                        <li>1</li>
                                        <li>2</li>
                                        <li>1</li>
                                        <li>1</li>
                                    </ul>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Horas extra</b>
                                    <ul style="list-style-type:none">
                                        <li>Analisis Funcional
                                            remoto</li>
                                        <li>Desarrollo remoto</li>
                                        <li>Desarrollo Extra remoto
                                        </li>
                                        <li>Analisis tecnico remoto
                                        </li>
                                    </ul>
                                </td>
                                <td style="text-align:right">
                                    <b>7</b>
                                    <ul style="list-style-type:none">
                                        <li>2</li>
                                        <li>2</li>
                                        <li>2</li>
                                        <li>1</li>
                                    </ul>
                                </td>
                                <td style="text-align:right">
                                    <b>4</b>
                                    <ul style="list-style-type:none">
                                        <li>1</li>
                                        <li>1</li>
                                        <li>1</li>
                                        <li>1</li>
                                    </ul>
                                </td>
                                <td style="text-align:right">
                                    <b>5</b>
                                    <ul style="list-style-type:none">
                                        <li>1</li>
                                        <li>2</li>
                                        <li>1</li>
                                        <li>1</li>
                                    </ul>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <b>Monto extra</b>
                                    <ul style="list-style-type:none">
                                        <li>Analisis Funcional
                                            remoto</li>
                                        <li>Desarrollo remoto</li>
                                        <li>Desarrollo Extra remoto
                                        </li>
                                        <li>Analisis tecnico remoto
                                        </li>
                                    </ul>
                                </td>
                                <td style="text-align:right">
                                    <b>70000</b>
                                    <ul style="list-style-type:none">
                                        <li>20000</li>
                                        <li>23254</li>
                                        <li>20121</li>
                                        <li>10000</li>
                                    </ul>
                                </td>
                                <td style="text-align:right">
                                    <b>40000</b>
                                    <ul style="list-style-type:none">
                                        <li>10000</li>
                                        <li>10000</li>
                                        <li>10000</li>
                                        <li>10000</li>
                                    </ul>
                                </td>
                                <td style="text-align:right">
                                    <b>50000</b>
                                    <ul style="list-style-type:none">
                                        <li>10000</li>
                                        <li>20000</li>
                                        <li>10000</li>
                                        <li>10000</li>
                                    </ul>
                                </td>
                            </tr>
                        </tbody>
                    </table-->
                </page>
            </xpath>
        </field>
    </record>
</odoo>
